function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){var t;if("function"==typeof define&&define.amd&&(define(e),t=!0),"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&(module.exports=e(),t=!0),!t){var n=window.Cookies,i=window.Cookies=e();i.noConflict=function(){return window.Cookies=n,i}}}(function(){function d(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function c(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function e(r){function s(){}function n(e,t,n){if("undefined"!=typeof document){"number"==typeof(n=d({path:"/"},s.defaults,n)).expires&&(n.expires=new Date(+new Date+864e5*n.expires)),n.expires=n.expires?n.expires.toUTCString():"";try{var i=JSON.stringify(t);/^[\{\[]/.test(i)&&(t=i)}catch(e){}t=r.write?r.write(t,e):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var o="";for(var a in n)n[a]&&(o+="; "+a,!0!==n[a]&&(o+="="+n[a].split(";")[0]));return document.cookie=e+"="+t+o}}function t(e,t){if("undefined"!=typeof document){for(var n={},i=document.cookie?document.cookie.split("; "):[],o=0;o<i.length;o++){var a=i[o].split("="),s=a.slice(1).join("=");t||'"'!==s.charAt(0)||(s=s.slice(1,-1));try{var d=c(a[0]);if(s=(r.read||r)(s,d)||c(s),t)try{s=JSON.parse(s)}catch(e){}if(n[d]=s,e===d)break}catch(e){}}return e?n[e]:n}}return s.set=n,s.get=function(e){return t(e,!1)},s.getJSON=function(e){return t(e,!0)},s.remove=function(e,t){n(e,"",d(t,{expires:-1}))},s.defaults={},s.withConverter=e,s}(function(){})});var demwaitjquery=setInterval(function(){"undefined"!=typeof jQuery&&(clearInterval(demwaitjquery),jQuery(document).ready(democracyInit))},50);function democracyInit(u){var h=".democracy",i=u(h);if(i.length){var o,m=".dem-screen",s=".dem-add-answer-txt",t=u(".dem-loader:first"),p={};p.opts=i.first().data("opts"),p.ajaxurl=p.opts.ajax_url,p.answMaxHeight=p.opts.answs_max_height,p.animSpeed=parseInt(p.opts.anim_speed),p.lineAnimSpeed=parseInt(p.opts.line_anim_speed),setTimeout(function(){function e(){t.each(function(){p.setHeight(u(this),1)})}var t=i.find(m).filter(":visible");t.demInitActions(1),u(window).on("resize.demsetheight",e),u(window).on("load",e),p.maxAnswLimitInit();var n=u(".dem-cache-screens");0<n.length&&n.demCacheInit()},1),u.fn.demInitActions=function(t){return this.each(function(){var e=u(this),n="data-dem-act";e.find("["+n+"]").each(function(){var t=u(this);t.attr("href",""),t.on("click",function(e){e.preventDefault(),t.blur().demDoAction(t.attr(n))})}),e.find("input[type=radio][data-dem-act=vote]").first().length&&e.find(".dem-vote-button").hide(),p.setAnswsMaxHeight(e),p.lineAnimSpeed&&e.find(".dem-fill").each(function(){var e=u(this);setTimeout(function(){e.animate({width:e.data("width")},p.lineAnimSpeed)},p.animSpeed,"linear")}),p.setHeight(e,t),e.find("form").on("submit",function(e){e.preventDefault(),u(this).find('input[name="dem_act"]').val()&&u(this).demDoAction(u(this).find('input[name="dem_act"]').val())})})},u.fn.demSetLoader=function(){var e=this;return t.length?e.closest(m).append(t.clone().css("display","table")):o=setTimeout(function(){p.demLoadingDots(e)},50),this},u.fn.demUnsetLoader=function(){return t.length?this.closest(m).find(".dem-loader").remove():clearTimeout(o),this},u.fn.demAddAnswer=function(){var e=this.first(),t=e.closest(m),n=0<t.find("[type=checkbox]").length,i=u('<input type="text" class="'+s.replace(/\./,"")+'" value="">');if(t.find(".dem-vote-button").show(),t.find("[type=radio]").each(function(){u(this).on("click",function(){e.fadeIn(300),u(s).remove()}),"radio"===u(this)[0].type&&(this.checked=!1)}),e.hide().parent("li").append(i),i.hide().fadeIn(300).focus(),n){var o=t.find(s);u('<span class="dem-add-answer-close">Ã—</span>').insertBefore(o).css("line-height",o.outerHeight()+"px").on("click",function(){var e=u(this).parent("li");e.find("input").remove(),e.find("a").fadeIn(300),u(this).remove()})}return!1},u.fn.demCollectAnsw=function(){var e=this.closest("form"),t=e.find("[type=checkbox],[type=radio],[type=text]"),n=e.find(s).val(),i=[],o=t.filter("[type=checkbox]:checked");if(0<o.length)o.each(function(){i.push(u(this).val())});else{var a=t.filter("[type=radio]:checked");a.length&&i.push(a.val())}return n&&i.push(n),(i=i.join("~"))||""},u.fn.demDoAction=function(e){var t=this.first(),n=t.closest(h),i={dem_pid:n.data("opts").pid,dem_act:e,action:"dem_ajax"};return void 0===i.dem_pid?console.log("Poll id is not defined!"):"vote"!==e||(i.answer_ids=t.demCollectAnsw(),i.answer_ids)?"delVoted"===e&&!confirm(t.data("confirm-text"))||("newAnswer"===e?t.demAddAnswer():(t.demSetLoader(),u.post(p.ajaxurl,i,function(e){t.demUnsetLoader(),t.closest(m).html(e).demInitActions(),setTimeout(function(){u("html:first,body:first").animate({scrollTop:n.offset().top-70},500)},200)}))):p.demShake(t),!1},u.fn.demCacheShowNotice=function(e){var t=this.first(),n=t.find(".dem-youarevote").first();return"blockForVisitor"===e&&(t.find(".dem-revote-button").remove(),n=t.find(".dem-only-users").first()),t.prepend(n.show()),setTimeout(function(){n.slideUp("slow")},1e4),this},p.cacheSetAnswrs=function(n,e){var t=e.split(/,/);if(n.hasClass("voted")){var i=n.find(".dem-answers"),o=i.data("voted-class"),a=i.data("voted-txt");u.each(t,function(e,t){n.find('[data-aid="'+t+'"]').addClass(o).attr("title",function(){return a+u(this).attr("title")})}),n.find(".dem-vote-link").remove()}else{var s=n.find("[data-aid]"),d=n.find(".dem-voted-button");u.each(t,function(e,t){s.filter('[data-aid="'+t+'"]').find("input").prop("checked","checked")}),s.find("input").prop("disabled","disabled"),n.find(".dem-vote-button").remove(),d.length?d.show():(n.find('input[value="vote"]').remove(),n.find(".dem-revote-button-wrap").show())}},u.fn.demCacheInit=function(){return this.each(function(){var e=u(this),n=e.prevAll(h+":first");if(n.length||(n=e.closest(h)),n.length){var i=n.find(m).first(),t=n.data("opts").pid,o=Cookies.get("demPoll_"+t),a="notVote"===o,s=!(void 0===o||a),d=e.find(m+"-cache.vote").html(),r=e.find(m+"-cache.voted").html();if(d){var c=s&&r;if(i.html((c?r:d)+"\x3c!--cache--\x3e").removeClass("vote voted").addClass(c?"voted":"vote"),s&&p.cacheSetAnswrs(i,o),i.demInitActions(1),!a&&!s&&1==e.data("opt_logs")){function f(){l=setTimeout(function(){if(!n.hasClass("checkAnswDone")){n.addClass("checkAnswDone");var t=n.find(".dem-link").first();t.demSetLoader(),u.post(p.ajaxurl,{dem_pid:n.data("opts").pid,dem_act:"getVotedIds",action:"dem_ajax"},function(e){t.demUnsetLoader(),e&&(i.html(r),p.cacheSetAnswrs(i,e),i.demInitActions(),i.demCacheShowNotice(e))})}},700)}var l;n.on("mouseenter",f).on("mouseleave",function(){clearTimeout(l)}),n.on("click",f)}}}else console.warn("Democracy: Main dem div not found")})},p.detectRealHeight=function(e){var t=e.clone().css({height:"auto"}).insertBefore(e),n="border-box"===t.css("box-sizing")?parseInt(t.css("height")):t.height();return t.remove(),n},p.setHeight=function(e,t){var n=p.detectRealHeight(e);t?e.css({height:n}):e.css({opacity:0}).animate({height:n},p.animSpeed,function(){u(this).animate({opacity:1},1.5*p.animSpeed)})},p.setAnswsMaxHeight=function(t){if("-1"!==p.answMaxHeight&&"0"!==p.answMaxHeight&&p.answMaxHeight){var n=t.find(".dem-vote, .dem-answers").first(),i=parseInt(p.answMaxHeight);if(n.css({"max-height":"none","overflow-y":"visible"}),100<("border-box"===n.css("box-sizing")?parseInt(n.css("height")):n.height())-i){n.css("position","relative");function o(){e.addClass("expanded").removeClass("collapsed")}function a(){e.addClass("collapsed").removeClass("expanded")}var s,e=u('<span class="dem__collapser"><span class="arr"></span></span>').appendTo(n);t.data("expanded")?o():(a(),n.height(i).css("overflow-y","hidden")),e.on("mouseenter",function(){t.data("expanded")||(s=setTimeout(function(){e.trigger("click")},1e3))}).on("mouseleave",function(){clearTimeout(s)}),e.on("click",function(){if(clearTimeout(s),t.data("expanded"))a(),t.data("expanded",!1),t.height("auto"),n.stop().css("overflow-y","hidden").animate({height:i},p.animSpeed,function(){p.setHeight(t,!0)});else{o();var e=p.detectRealHeight(n);e+=7,t.data("expanded",!0),t.height("auto"),n.stop().animate({height:e},p.animSpeed,function(){p.setHeight(t,!0),n.css("overflow-y","visible")})}})}}},p.maxAnswLimitInit=function(){i.on("change",'input[type="checkbox"]',function(){var e=u(this).closest(h).data("opts").max_answs,t=u(this).closest(m).find('input[type="checkbox"]');e<=t.filter(":checked").length?t.filter(":not(:checked)").each(function(){u(this).prop("disabled",!0).closest("li").addClass("dem-disabled")}):t.each(function(){u(this).prop("disabled",!1).closest("li").removeClass("dem-disabled")})})},p.demShake=function(e){var t=e.css("position");for(t&&"static"!==t||e.css("position","relative"),t=1;t<=2;t++)e.animate({left:-10},50).animate({left:10},100).animate({left:0},50)},p.demLoadingDots=function(e){var t=e,n=t.is("input"),i=n?t.val():t.html();"..."===i.substring(i.length-3)?n?t[0].value=i.substring(0,i.length-3):t[0].innerHTML=i.substring(0,i.length-3):n?t[0].value+=".":t[0].innerHTML+=".",o=setTimeout(function(){p.demLoadingDots(t)},200)}}}
//# sourceMappingURL=democracy.min.js.map
